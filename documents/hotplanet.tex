% This file is part of the StellarClocks project.
% Copyright 2014 the authors.

\documentclass[12pt, preprint]{aastex}

\input{vc}
\newcounter{affil}
\newcommand{\project}[1]{\textsl{#1}}
\newcommand{\Kepler}{\project{Kepler}}
\newcommand{\given}{\,|\,}
\newcommand{\DeltaTKepler}{\Delta T_{\mathrm{Kep}}}

\begin{document}

\title{
  Short-period exoplanets as clocks for long-period exoplanet discovery.
}
\author{
  David~W.~Hogg\altaffilmark{\ref{ccpp},\ref{cds},\ref{mpia},\ref{email}},
  and
  Dan~Foreman-Mackey\altaffilmark{\ref{ccpp}}
}
\date{DRAFT VERSION / \texttt{\githash}\ / \today\ / NOT FOR DISTRIBUTION}
\refstepcounter{affil}\label{ccpp}\altaffiltext{\ref{ccpp}}{%
CCPP, NYU Physics
}
\refstepcounter{affil}\label{cds}\altaffiltext{\ref{cds}}{%
NYU CDS
}
\refstepcounter{affil}\label{mpia}\altaffiltext{\ref{mpia}}{%
MPIA
}
\refstepcounter{affil}\label{email}\altaffiltext{\ref{email}}{%
david.hogg@nyu.edu
}

\begin{abstract}
A significant fraction of stars have very short-period planets,
measurable at high signal-to-noise in \Kepler\ (or similar) data.
The periodic transit signal can be used like a clock, sensitive to
anomalous time delays generated by stellar motions.
In particular, they can be used to detect and characterize the
movement of a star in response to longer-period orbital companions,
including massive exoplanets.
Here we discuss the opportunities for using residuals in periodic
transit timing to discover and characterize long-period exoplanet
companions.
The residuals do not have the same character as what are known as
``transit-timing variations'', because they are not caused by
gravitational perturbations on the planet; they are caused by the
reflex motion of the host star around the extrasolar system barycenter
induced by the long-period planet's orbit.
We implement and demonstrate a method on real \Kepler\ data.  We find
that we can detect exoplanet-induced timing residuals with amplitudes
of $\sim XXX$~s in some typical systems with large, short-period
transiting planets (for context, Jupiter induces timing residuals in
the Sun with a semi-amplitude of 2.3~s).
We perform a rudimentary search in NNN systems and discover YYY
long-period exoplanet candidates.
\end{abstract}

\section{Introduction}

...Pulsar planets.  Exactly how do you find these?

...Hot Jupiters.  What do we know about abundance and coherence as
clocks?

...Time delay as a function of orbital phase.  Different from radial
velocity, similar to astrometric wobble.  Encodes as much information
about the orbit as the radial velocity, but with different units.

...Context of the Solar System and known Kepler and RV planets.

...Connection to R\o mer and history.

\section{Signal generalities}

...How, in general, the signal is to be found...

...How precisely the signal can be found...
Given a set of oscillation modes $m$ with oscillation periods $P_m$,
our ability to find a long-period signal (meaning a signal which
varies on time-scales much longer than the oscillation frequencies) of
known functional form and amplitude $T_0$ (time units) is given
roughly by:
\begin{eqnarray}
\frac{1}{\sigma_T^2} &\sim& \sum_m \frac{\DeltaTKepler^2}{P_m^4}\,\left(\frac{S}{N}\right)_m^2
\quad ,
\end{eqnarray}
where $\sigma_T$ is the uncertainty on the amplitude $T_0$,
$\DeltaTKepler$ is the lifetime of the \Kepler\ mission data, and
$(S/N)_m$ is the signal-to-noise with which mode $m$ is detected.
This formula assumes that the oscillations are more-or-less coherent
over the lifetime of the mission, which appears to be true
empirically.
There is a pre-factor of order unity that depends on the functional
form of the signal and other details.
This precision estimate depends incredibly strongly on period:
Much shorter periods are far more valuable.
Hence the value of the millisecond pulsars!

If you can measure the timing amplitude $T_0$, you get a measure of
the line-of-sight semi-major axis projection $a\,\sin i$.
The amplitude $T_0$ rises linearly with the separation $a$ between the
planet and star, just like the astrometric wobble amplitude.
If you can \emph{also} measure the astrometric amplitude $\theta_0$,
you get the distance.
The proper-motion distance, to be very specific.
If you measure the timing amplitude $T_0$ and also transits, the
inclination is usually very highly constrained and $a\,\sin i$ becomes
a complete measurement of $a$.
(If you can also measure the radial velocity and period, you get a
measure of the speed of light.)

In principle, the one-dimensional projection (onto the line of sight)
of the full Keplerian eccentric orbit shape is encoded in the time
history, so in principle we can measure the eccentricity and
orientation of the argument of perihelion.
Indeed, the time-delay function of time is just the integral of the
radial velocity function of time; anything that can be inferred from
radial-velocity data can be inferred from time-delay data.
That said, the sensitivities to noise will be different, and good
inferences will require very good time-delay data.

\section{Methods}

Our general approach is to take periodograms of the data.
The idea is that if we distort the time axis of the data---effectively
``un-doing'' the time-delay effects created by the orbit of a
planetary companion---the periodogram will get more informative as the
distortion better matches the inverse of the time-delay distortion
induced by reaction of the star to the movement of the planet.
That is, the planet creates a time-delay pattern in the data; we un-do
that pattern and watch the stellar oscillation modes get ``sharper''.

The method is based on the fact that a periodogram is related
(beautifully) to a marginalized likelihood function
(\citealt{bretthorst}):
\begin{eqnarray}
\ln p(d\given P_m) &=& \frac{C(P_m)}{\sigma^2} + \mbox{const}
\quad,
\end{eqnarray}
where $p(d\given P_m)$ is a likelihood function, $d$ is the
light-curve data on the target star, $P_m$ is the period of a putative
sinusoidal signal---here an asteroseismology mode $m$---generating the
data, $C(P_m)$ is the periodogram (best-fit squared amplitude as a
function of period $P_m$) and $\sigma^2$ is the per-datum noise
variance (assumed Gaussian, independent, and all identical).
This is a \emph{marginalized} likelihood, because phase and amplitude
have been marginalized out (with trivial prior pdfs); the likelihood
depends only on period.
The periodogram $C(P)$ is defined to be the square of the best-fit
amplitude of a sinusoidal signal, with arbitrary phase but period $P$,
fit by least squares to zero-mean data $d$.
The data blob $d$ consists of a set of $N$ measurements $d_n$, each of
which has a corresponding time $t_n$ and uncertainty (noise amplitude)
$\sigma$.
The time points are unevenly spaced in general; in practice we compute
the periodogram by the standard procedure for unevenly-spaced data
(CITE).

...Figure XXX shows a blow-up of the periodogram of the \Kepler\ data
on target star YYY near one of its modes.

Of course we are not really looking for the modes at periods $P_m$;
for our purposes, asteroseismology itself is a ``solved problem''.
We are looking for a time-delay function $h(t\given \omega)$ such that
if we un-delay the data by this function, each asteroseismology mode
$m$ becomes more faithfully represented in the data.
Here $\omega$ is the set of exoplanet parameters, which include a
time-delay amplitude $T_0$, a period $P$, an eccentricity $e$, an
argument of perhielion $\varpi$ and so on.
For the purposes of what follows, we define here a distorted
periodogram $C(P\given\omega)$ which is the periodogram obtained after
moving each time point $t_n$ by a time displacement
$-h(t_n\given\omega)$.
This leads to our new likelihood function
\begin{eqnarray}
\ln p(d\given P_m, \omega) &=& \frac{C(P_m\given\omega)}{\sigma^2} + \mbox{const}
\quad,
\end{eqnarray}
where $\omega$ is the blob of exoplanet parameters.

This likelihood function---which is a function of mode period $P_m$
and exoplanet parameters $\omega$---can be optimized to generate a
point estimate, or multiplied by a prior to make posterior inferences.
Here we demonstrate feasibility with simple optimization (maximum
likelihood).
More can be done with a posterior pdf approach, including possibly
MCMC sampling, but that is beyond the present scope.

...The above might not be correct: The $P_m$-marginalized likelihood
(that is only a function of $\omega$) would be very easy to generate
in the quadratic/Gaussian approximation.  Maybe we should do that!

...describe finding a peak.  And then measuring that peak as a
function of $\omega$, or integrating it over $P_m$ as a function of
$\omega$.

...Information coming from multiple modes can be combined.  Describe
this.

...Approximations abound.

\section{Experiments with \Kepler\ data}

\section{Discussion}

...Key summary

...Possibility of characterizing all known exoplanets hosted by giant stars

...Possibility of search

\acknowledgements
It is a pleasure to thank
  Hans-Walter Rix (MPIA)
for useful discussions.
This research was partially supported by the NSF (grant XXX), NASA
(grant XXX), and the Moore and Sloan Foundations.
This research made use of the NASA Astrophysics Data System, and
open-source software including Python, numpy, scipy, and matplotlib.

\begin{thebibliography}{}\raggedright
\bibitem[Bretthorst(1988)]{bretthorst}
  Bretthorst, G. L., 1988,
  \textit{Bayesian Spectrum Analysis and Parameter Estimation},
  in \textit{Lecture Notes in Statistics} \textbf{48},
  Springer-Verlag, New York
  \footnotesize{(\url{http://bayes.wustl.edu/glb/book.pdf})}
\end{thebibliography}

\end{document}
