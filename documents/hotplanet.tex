% This file is part of the StellarClocks project.
% Copyright 2014 the authors.

\documentclass[12pt, preprint]{aastex}

\input{vc}
\newcounter{affil}
\newcommand{\sectionname}{Section}
\newcommand{\project}[1]{\textsl{#1}}
\newcommand{\Kepler}{\project{Kepler}}
\newcommand{\tick}{\mathrm{tick}}
\newcommand{\given}{\,|\,}

\begin{document}

\title{
  Using short-period transiting exoplanets as clocks \\
  for long-period exoplanet discovery
}
\author{
  David~W.~Hogg\altaffilmark{\ref{ccpp},\ref{cds},\ref{mpia},\ref{email}}
  \&
  Dan~Foreman-Mackey\altaffilmark{\ref{ccpp}}
}
\date{DRAFT VERSION / \texttt{\githash}\ / \today\ / NOT FOR DISTRIBUTION}
\refstepcounter{affil}\label{ccpp}\altaffiltext{\ref{ccpp}}{%
CCPP, NYU Physics
}
\refstepcounter{affil}\label{cds}\altaffiltext{\ref{cds}}{%
NYU CDS
}
\refstepcounter{affil}\label{mpia}\altaffiltext{\ref{mpia}}{%
MPIA
}
\refstepcounter{affil}\label{email}\altaffiltext{\ref{email}}{%
david.hogg@nyu.edu
}

\begin{abstract}
A significant fraction of stars have very short-period planets,
measurable at high signal-to-noise in \Kepler\ (or similar) data.
The periodic transit signal can be used like a clock, sensitive to
anomalous time delays generated by stellar motions.
In particular, they can be used to detect and characterize the
movement of a star in response to longer-period orbital companions,
including massive exoplanets.
Here we discuss the opportunities for using residuals in periodic
transit timing to discover and characterize long-period exoplanet
companions.
The residuals do not have the same character as what are known as
``transit-timing variations'', because they are not caused by
gravitational perturbations on the planet; they are caused by the
reflex displacement of the host star around the system barycenter
induced by the long-period planet's orbit.
We implement and demonstrate a method on real \Kepler\ data.  We find
that we can detect exoplanet-induced timing residuals with amplitudes
of $\sim XXX$~s in some typical systems with large, short-period
transiting planets (for context, Jupiter induces in-plane timing residuals in
the Sun with a semi-amplitude of 2.5~s).
We perform a rudimentary search in NNN systems and discover YYY
long-period exoplanet candidates.
\end{abstract}

\section{Introduction}

...Pulsar planets.  Exactly how do you find these?

...Hot Jupiters.  What do we know about abundance and coherence as
clocks?

...Time delay as a function of orbital phase.  Different from radial
velocity, similar to astrometric wobble.  Encodes as much information
about the orbit as the radial velocity, but with different units.

...Context of the Solar System and known Kepler and RV planets.

...Connection to R\o mer and history.

\section{Signal generalities}

There are two qualitatively different methods for exoplanet discovery
via timing with a precise stellar ``clock''.
The first is to look at the ``clock rate'' and see that the clock runs
faster as it approaches us, and slower as it recedes.
This is very similar, in some sense, to the radial-velocity method for
finding exoplanets; it is more sensitive to planets that induce larger
reaction velocities in the parent star, because clock rate changes are
driven by Doppler shifts.
If all that is used is the \emph{rate} of the clock, not all of the
information available is being exploited, because a precise clock has
phase coherence over the time of the experiment.

The second method captures that phase coherence.
It is to look at the timing residuals and see that the clock ``ticks''
are retarded (relative to a purely periodic signal) when the clock is
farther from us and advanced when the clock is closer.
This method is more sensitive to planets that induce larger reaction
\emph{displacements} in the parent star.
This latter method---timing residuals---is going to be more sensitive
in general, because it makes use of not just the frequency information
(the clock rate) but also the phase information (the coherent,
predictable arrival times of the transits).
It is also more sensitive to the larger-period planets, which are hard
to find by other methods.
For these reasons, we use the timing-residuals method in what follows.

In the method (below), we will find the signals by building a
generative model of the full data stream; that is, we won't measure
individual transit times explicitly.
However, in this \sectionname, just for discussion purposes, let's
imagine measuring a set of transit arrival times, that may have been
distorted by a time-dependent displacement of the parent star.  What
can be measured from such a signal, and how precisely can it be
measured?
The precision will depend on the properties of the star and the
observing program; here we estimate precision for the
\Kepler\ mission, but the analysis is generalizable.

If a typical hot-Jupiter transit in a typical star observed by
\Kepler\ lasts hours and is measured with a signal-to-noise of
thousands, then we might hope to be able to measure the time of that
transit (that clock ``tick'') to a precision $\delta t_\tick\sim
10$~s, depending in detail on the shape of the transit, the cadence of
the data, and the properties of the relevant noise sources (some of
which are intrinsic to the star).
A hot Jupiter might transit a hundred times $N_\tick\sim 100$ or
several hundred times in the duration of the \Kepler\ mission, so the
overall precision with which the equivalent, periodic clock could be
synchronized is potentially better than
\begin{eqnarray}
\delta t &\sim& \frac{\delta t_\tick}{\sqrt{N_\tick}}
\\
\delta t &\sim& 1~\mathrm{s}
\quad .
\end{eqnarray}
This sets the rough precision of a hot-Jupiter clock in \Kepler:
It should be useful for detecting exoplanet-induced timing drifts or
variations that have amplitudes substantially larger than 1~s within
the \Kepler\ mission.
For context, in the Solar System, Jupiter induces in-plane timing
residuals in the Sun with a semi-amplitude of 2.5~s.
This also illustrates that clocks with shorter periods (higher
$N_\tick$ in the mission lifetime) or sharper or louder ``ticks''
(smaller $\delta t_\tick$) are more valuable.

Of course this is naive in several respects: The first is that the
timing residuals induced by an outer exoplanet are varying
non-trivially with time; it should be easier to find signals that have
a period comparable to (or shorter than) the \Kepler\ mission
lifetime.
That is, the $\delta t$ precision is only an order-of-magnitude
estimate; it will be modified by the functional form of the timing
distortion we seek.
The second is that very long-period signals, even if they have large
amplitude, will only be detectable as clock drifts if they show
\emph{acceleration} (second derivative of displacement with time)
inside the \Kepler\ mission window (otherwise their effects are
equivalent to a non-varying period offset in the clock rate).
Just as with radial-velocity exoplanet discovery; in the limit of
large periods, it is only accelerations that are measureable.

...fix next paragraphs to flow

If you can measure the timing amplitude $T_0$, you get a measure of
the line-of-sight semi-major axis projection $a\,\sin i$.
The amplitude $T_0$ rises linearly with the separation $a$ between the
planet and star, just like the astrometric wobble amplitude.
If you can \emph{also} measure the astrometric amplitude $\theta_0$,
you get the distance.
The proper-motion distance, to be very specific.
If you measure the timing amplitude $T_0$ and also transits, the
inclination is usually very highly constrained and $a\,\sin i$ becomes
a complete measurement of $a$.
(If you can also measure the radial velocity and period, you get a
measure of the speed of light.)

In principle, the one-dimensional projection (onto the line of sight)
of the full Keplerian eccentric orbit shape is encoded in the time
history, so in principle we can measure the eccentricity and
orientation of the argument of perihelion.
Indeed, the time-delay function of time is just the integral of the
radial velocity function of time; anything that can be inferred from
radial-velocity data can be inferred from time-delay data.
That said, the sensitivities to noise will be different, and good
inferences will require very good time-delay data.

\section{Method}

...Likelihood function for a hot exoplanet

...Likelihood function for a hot planet with a cold-planet adjusting the timing.

...This likelihood function---which is a function of FIXME mode period $P_m$
and exoplanet parameters $\omega$---can be optimized to generate a
point estimate, or multiplied by a prior to make posterior inferences.
Here we demonstrate feasibility with simple optimization (maximum
likelihood).
More can be done with a posterior pdf approach, including possibly
MCMC sampling, but that is beyond the present scope.

...The above might not be correct: The $P_m$-marginalized likelihood
(that is only a function of $\omega$) would be very easy to generate
in the quadratic/Gaussian approximation.  Maybe we should do that!

...describe finding a peak.  And then measuring that peak as a
function of $\omega$, or integrating it over $P_m$ as a function of
$\omega$.

...Information coming from multiple modes can be combined.  Describe
this.

...Approximations abound.

\section{Experiments with \Kepler\ data}

\section{Discussion}

...Key summary

...Possibility of characterizing all known exoplanets hosted by giant stars

...Possibility of search

\acknowledgements
It is a pleasure to thank
  Hans-Walter Rix (MPIA)
for useful discussions.
This research was partially supported by the NSF (grant XXX), NASA
(grant XXX), and the Moore and Sloan Foundations.
This research made use of the NASA Astrophysics Data System, and
open-source software including Python, numpy, scipy, and matplotlib.

\begin{thebibliography}{}\raggedright
\bibitem[Bretthorst(1988)]{bretthorst}
  Bretthorst, G. L., 1988,
  \textit{Bayesian Spectrum Analysis and Parameter Estimation},
  in \textit{Lecture Notes in Statistics} \textbf{48},
  Springer-Verlag, New York
  \footnotesize{(\url{http://bayes.wustl.edu/glb/book.pdf})}
\end{thebibliography}

\end{document}
